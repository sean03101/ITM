---
title: "D2"
author: "Tae Hyeon Kwon, undergrad(ITM)"
date: '`r Sys.Date()` '
output: pdf_document
---

*page 17*
```{python}
import numpy as np

P = np.array([0.7,0.3,0.5,0.5]).reshape(2,2)
R = np.array([1.5,1.0]).reshape(2,1)

gamma = 0.9
v = np.dot(np.linalg.inv(np.identity(2)-gamma*P),R)

print(v)

```

\newpage
*page 23*
```{python}
import numpy as np

P = np.array([0.7,0.3,0.5,0.5]).reshape(2,2)
R = np.array([1.5,1.0]).reshape(2,1)

gamma = 0.9
epsilon = 10**(-8)
v_old = np.zeros((2,1))
v_new = R + np.dot(gamma*P,v_old)

while np.max(abs(v_new-v_old))>epsilon:
    v_old = v_new
    v_new = R + np.dot(gamma*P,v_old)


print(v_old)

```


\newpage
*page 24*
```{python}
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

P = np.array([0.7,0.3,0.5,0.5]).reshape(2,2)
R = np.array([1.5,1.0]).reshape(2,1)

gamma = 0.9
epsilon = 10**(-8)
v_old = np.zeros((2,1))
v_new = R + np.dot(gamma*P,v_old)

results = v_old.T
results = np.append(results,v_new.T,axis=0)

while np.max(abs(v_new-v_old))>epsilon:
    v_old = v_new
    v_new = R + np.dot(gamma*P,v_old)
    results = np.append(results,v_new.T,axis=0)

results = pd.DataFrame(results,columns=['coke','pepsi'])

print(results.head(n=7))

print(results.tail(n=7))


plt.scatter(results.index, results['coke'], label='coke')
plt.scatter(results.index, results['pepsi'], label='pepsi')
plt.xlabel('idx')
plt.ylabel('value_fn')
plt.show()
```
\newpage
*page 27 (after 50 steps)*
```{python}
plt.scatter(results.index[49:],results['coke'][49:], label='coke')
plt.xlabel('idx')
plt.ylabel('value_fn')
plt.show()


```
\newpage
*page 27 (after 100 steps)*
```{python}
plt.scatter(results.index[99:],results['coke'][99:], label='coke')
plt.xlabel('idx')
plt.ylabel('value_fn')
plt.show()
```


