---
title: "Lecture B1.Newsvendor"  
author: "Bong Seok Kim"  
date: "`r Sys.Date()`"  
output:   
  pdf_document:  
    latex_engine: xelatex
    highlight: haddock  
    keep_tex: true  
    includes:
      in_header: rmd-pdf-support/latex-topmatter.tex
    # pandoc_args: [
    #  "-V", "classoption=twocolumn"
    # ]
    toc: true   
    toc_depth: 2  
    # number_sections: true  
monofont: Consolas
smaller: yes
classoption: a4paper
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(background = '718CBA')  
```

## *Exercise 1*
Assume that $D$ follows the following discrete distribution.


\begin{table}[ht]
  \begin{tabular}{l|llll}
  \hline
  d             & 20  & 25  & 30  & 35  \\ \hline
  P{[}D=d{]}    & 0.1 & 0.2 & 0.4 & 0.3 \\ \hline
  $30 \wedge d$ & 20  & 25  & 30  & 30  \\
  $(30-d)^+$    & 10  & 5   & 0   & 0   \\
  $24 \wedge d$ & 20  & 24  & 24  & 24  \\
  $(24-D)^+$    & 4   & 0   & 0   & 0   \\ \hline
  \end{tabular}
  \end{table}


Answer the followings.

solution:
\begin{itemize}
  \item $E[30\land D] =$ $0.1(20) +0.2(25) +0.4(30)+0.3(30) = 28$    
  \item $E[(30- D)^+] =$ $0.1(10) +0.2(5) +0.4(0)+0.3(0) = 2$    
  \item $E[24\land D] =$ $0.1(20) +0.2(24) +0.4(24)+0.3(24) = 23.6$      
  \item $E[(24-D)^+] =$  $0.1(4) +0.2(0) +0.4(0)+0.3(0) = 0.4$     
\end{itemize}


\newpage
## Exercise 2 
Find your brother`s optimal stock level by the above Theorem 2. Then find his expected profit using the Remark 1

### solution for optimal stock:

|Demand|11|12|13|14|15|||
|--|--|--|--|--|--|
|$P[D=d|$|0.2|0.2|0.2|0.2|0.2|
|$P[D\leq d]$|0.2|0.4|0.6|0.8|1.0|

\
*Thereom 2 
\begin{itemize}
\item $c_o = 2-1 = 1$
\item $c_u = 1-0.5 = 0.5$
\item $F(y) \ge \frac{c_u}{c_o+c_u}$ = $1 \over 0.5+1$ = $2 \over 3$ \ Thus, according to above table, $x^*=14$
\end{itemize}



### solution for expected profit:

Expected profit = $\mathbb{E}[profit]=\mathbb{E}(sale\,\,rev.)+\mathbb{E}(salvage\,\,rev.)-\mathbb{E}(material\,\,cost)$


 |Stock \ Demand|11|12|13|14|15|Expected Profit||||
|--|--|--|--|--|--|--|
|$14$|$11(2)+3(0.5)-14(1)=9.5$|$12(2)+2(0.5)-14(1)=11$|$13(2)+0(0.5)-14(1)=12.5$|$13(2)+0(0.5)-14(1)=14$|$14(2)+0(0.5)-14(1)=14$|$0.2(9.5)+0.2(11)+0.2(12.5)+0.2(14)+0.2(14)=12.2$|

Thus, Expected profit is 12.2 when $x^*= 14$



\newpage
## Excercise 3
Your brother is now selling milk. The customer demands follows $U(20,40)$ gallons. Retail price is \$2 per gallon, material cost is \$1 per gallon, and salvage cost is \$ 0.5 per gallon.
Find optimal stock level and expected profit

\vspace{5pt}


\[f(x)=
\begin{Bmatrix}
\frac{1}{20} \,\,(20\leq x\leq 40) \\ 0 \,\,\,\,\,\,\,\,\,\,\,\,\, otherwise
\end{Bmatrix}
\]

\[F(x)=
\begin{Bmatrix}
0 \,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,(20\leq x) \\ \frac{x-20}{20} \,\,\,\,\,\,\,(20\leq x \leq 40) \\1 \,\,\,\,\,\,\,\,\,\,\,\,\,(x>40)
\end{Bmatrix}
\]


### solution for optimal stock:

\begin{itemize}
  \item $c_o =1-0.5=0.5$
  \item $c_u=2-1=1$
  \item $F(y) =\frac{c_u}{c_o+c_u}$ = $1 \over 0.5+1$ = $2 \over 3$ 
  \item $x^*=F({2\over3})^{-1}=(40-20){2 \over 3}+20= {100 \over3}$
\end{itemize}

\vspace{5pt}

### solution for expected profit:

$\mathbb{E}[profit]=\mathbb{E}(sale\,\,rev.)+\mathbb{E}(salvage\,\,rev.)-\mathbb{E}(material\,\,cost)\\$
$= 2E[D\land X^*]+0.5E[(D-X^*)^+]-E[X^*] \\ =2E[D\land {100 \over 3}]+0.5E[(D-{100 \over 3})^+]-E[{100 \over 3}]$ 

Using this information, compute the expectations directly by integration

1.$E[D\land {100 \over 3}] =$ $\int_{-\infty}^{\infty}(X∧\frac{100}{3})f(x) dx \\ = \int_{20}^{40}(X∧\frac{100}{3})\frac{1}{20}dx$ 


$= \int_{20}^{100 \over 3}(X)\frac{1}{20}dx+ \int_{100 \over 3}^{40}({100 \over 3}){1 \over 20} = {260 \over 9}$



\vspace{5pt}
2.$E[(X-{100 \over 3})^+] =$ $\int_{-\infty}^{\infty}((X-{100 \over 3})^+)f(x) dx \\ = \int_{20}^{40}(X-{100 \over 3})^+\frac{1}{20}dx$ 


$= \int_{20}^{100 \over 3}(0)\frac{1}{20}dx+ \int_{100 \over 3}^{40}(X-{100 \over 3}){1 \over 20} = {10 \over 9}$




\vspace{5pt}
3.$E[{100 \over 3} ] = {100 \over 3}$


according to formula above, $2({260 \over 9})+0.5({40 \over 9}) -{100 \over 3} = {80 \over 3} \\$

Thus, Expected profit is ${80 \over 3}$



\newpage 

## Excercise 4
Lemonade sells for \$18 per gallon but only costs \$3 per gallon to make. if we run out of lemonade. it will be impossible to get more. On the other hand, leftover lemonade has a value of \$1. Express The following quantity using sale as X and demand as D


### Solution : 

\vspace{5pt}

\begin{itemize}
  \item $c_u$=(p-c)=(18-3)=15
  \item $c_o$=(c-s)=(3-1)=2  
  \item Expected Economic Cost = OverStock Cost + UnderStock Cost $\\ =c_o(X-D)^+c_u(D-X)^+=2(X-D)^++15(D-X)^+$
  \item Expected Profit = $15(X \land D)+2(X-D)^+-3X$
\end{itemize}



\newpage 

## Excercise 5
Prove Theorem 1. (Hint: you may use formulation from Exercise 4)

### Solutuon :

\begin{itemize}
  \item $c_u$ = understock cost = $(p-c)(D-X)^+$
  \item $c_o$ = overstock cost = $(c-s)(X-D)^+$ 
\end{itemize}

Expected Economic Cost = $(p-c)(D-X)^+$ +$(c-s)(X-D)^+$ 

Expected Profit = $p(D \land X ) +s(X-D)^+ -cX$

we will minimize
expected cost then the long-run average cost will be also guaranteed to be minimized


E[E_cost]=$c_o \int_ {y}^{\infty}(X-D)f_D(x)dx+c_u \int_ {0}^{y}(D-X)f(x)dx$

${d \over dy}$ E[cost]=$c_u(F_D(y)-1)+C_o(F_D(y) =0$

$F_D(y)(c_u+c_o)=c_u$

$F_D(y)$=${c_u \over c_u+c_o}$ \quad (1)

${d^2\over d^2y}E(cost)=(c_u+c_o)f_D(y)$ \quad (2)

(2) is always nonnegative because $0\leq c_u, c_o$
Therefore, y* obtained from (1) minimizes the cost instead of maximizing it.


Since the profit maximization problem solved previously and the cost minimization problem solved now share the same logic, Maximizing the expected profit is equvalent to
Minimizing the expected economic cost

\newpage

## DaiPark Excercise 4
Let D be a continuous random variable and uniformly distributed between
5 and 10. Find

(a) $E[max(D, 8)]$ 

(b) $E[(D − 8)^-]$

where $x^{-1} = min(x, 0)$


### solution:

$f_d(x)=\begin{cases}\frac{1}{5}&5\le x \le 10\\0&otherwise\end{cases}$  

$F_d(x)=\begin{cases}0&5<x\\\frac{x-5}{5}&5\le x \le 10\\1&x>10\end{cases}$ 


(a) \begin{eqnarray*}
  E[max(D,8)]&=&\int_{-\infty}^{\infty}max(X,8)f(x)dx \\
    \\
  &=&\int_{-\infty}^{5}max(X,8)f(x)dx+\int_{5}^{10}max(X,8)f(x)dx+\int_{10}^{\infty}max(X,8)f(x)dx \\
  &=& 0+\int_{5}^{10}max(X,8){1\over 5}dx +0 \\
    \\
   &=&\int_{5}^{8}(8){1 \over 5}dx +\int_{8}^{10}(x){1 \over 5}dx \\
    \\
   &=& 8.4
\end{eqnarray*} 
 

(b) \begin{eqnarray*}
  E[(D − 8)^-]&=&\int_{-\infty}^{\infty}(X-8)^{-} f(x)dx \\
    \\
  &=&\int_{-\infty}^{5}(X-8)^{-}f(x)dx+\int_{5}^{10}(X-8)^{-}f(x)dx+\int_{10}^{\infty}(X-8)^{-})f(x)dx \\
  &=& 0+\int_{5}^{10}(X-8)^{-}{1\over 5}dx +0 \\
    \\
   &=&\int_{5}^{8}(X-8){1 \over 5}dx +\int_{8}^{10}(0){1 \over 5}dx \\
    \\
   &=&\int_{5}^{8}(X-8){1 \over 5}dx \\
   \\
   &=& -0.9
\end{eqnarray*} 

\newpage

## DaiPark Excercise 7

Suppose we are selling lemonade during a football game. The lemonade sells for \$18 per gallon but only costs \$3 per gallon to make. If we run out of lemonade during the game, it will be impossible to get more. On
the other hand, leftover lemonade has a value of $1. Assume that we believe the fans would buy 10 gallons with probability 0.1, 11 gallons with
probability 0.2, 12 gallons with probability 0.4, 13 gallons with probability 0.2, and 14 gallons with probability 0.1.


### (a) What is the mean demand?
### (b) If 11 gallons are prepared, what is the expected profit?
### (c) What is the best amount of lemonade to order before the game?
### (d) Instead, suppose that the demand was normally distributed with mean 1000 gallons and variance 200 gallons2 How much lemonades hould be ordered?


### Solution:

\begin{table}[ht]
  \begin{tabular}{l|lllll}
  \hline
  Demand        & 10  & 11  & 12  & 13  & 14\\ \hline
  P{[}D=d{]}    & 0.1 & 0.2 & 0.4 & 0.2 & 0.1   \\ \hline
  \end{tabular}
  \end{table}


### (a)

mean demand = $\sum xP(x) = 10(0.1)+11(0.2)+12(0.4)+13(0.2)+14(0.1)$ =12  

### (b)

|Demand|10|12|13|14|Expected Profit|||
|--|--|--|--|--|--|--|
|$14$|$10(18)+1(1)-11(3)=148$|$11(18)+0(0)-11(3)=147$|$11(18)+0(0)-11(3)=147$|$11(18)+0(0)-11(3)=147$|$11(18)+0(0)-11(3)=147$|$0.1(148)+0.2(147)+0.4(147)+0.2(147)+0.1(147)=147.1$|

Thus, Expected profit is \$ 147.1 If 11 gallons are prepared

### (c)

$c_o = 3-1 = 2$


$c_u = 18-3 = 15$


If D is a discrete r.v with cdf F(x), then find smallest y s.t $F(y)\geq{c_u \over c_u+c_o}={15 \over 15+2}= {15 \over 17 }=0.88235$


|Demand|10|11|12|13|14|||
|--|--|--|--|--|--|
|$P[D=d|$|0.1|0.2|0.4|0.2|0.1|
|$P[D\leq d]$|0.1|0.3|0.7|0.9|1.0|


Thus, 13 is the best amount of lemonade before the game to order


### (d)
Demand~$N(1000,200^2)$

If D is a continuous r.v with cdf F(x), then find y s.t $F(y)={c_u \over c_u+c_o}={15 \over 15+2}= {15 \over 17 }=0.88235$

then in standard Normal Distribution $P(Z \leq 1.175)=0.88$


thus, ${X-100}\over 200 = 1.175$


$X= 1.175(200) +1000 = 1235$

we should prepare 1235 gallons.











\newpage
## DaiPark Excercise 14

A store sells a particular brand of fresh juice. By the end of the day, any
unsold juice is sold at a discounted price of $2 per gallon. The store gets
the juice daily from a local producer at the cost of $5 per gallon, and it
sells the juice at $10 per gallon. Assume that the daily demand for the
juice is uniformly distributed between 50 gallons to 150 gallons.


### (a) What is the optimal number of gallons that the store should order from the distribution each day in order to maximize the expected profit each day?

### (b) If 100 gallons are ordered, what is the expected profit per day?

### Solution:

information
\begin{itemize}
  \item Salvage Value= s=  \$2 per gallon 
  \item Wholesale price= c =\$5 per gallon
  \item retail price = p = \$10 per gallon 
  \item Demand distribution = U(50,150)
\end{itemize}

$c_o=c-s=5-2=3 \\$
$c_u=p-c=10-5=5$

#### (a) 

If D is a continous r.v with cdf F(x), then find y s.t $F(y)={c_u \over c_u+c_o}={5 \over 5+3}= {5 \over8 }\\$
$F({5\over8})^{-1}= (150-50){5 \over 8}+50= {112.5}\\$
Thus optimal number of gallon is 112.5 gallon to maximize the expected profit each day.

### (b) 

E(proit) = E(sales.rev)+E(slavage.rev)-E(material)


\begin{eqnarray*}
  E[(D\land 100)]&=&\int_{-\infty}^{\infty}(X \land 100)f(x)dx \\
    \\
  &=&\int_{-\infty}^{50}(X \land 100)f(x)dx+\int_{50}^{150}(X \land 100)f(x)dx+\int_{150}^{\infty}(X \land 100)f(x)dx \\
  &=& 0+\int_{50}^{150}(X \land 100)f(x)dx+0 \\
  &=&\int_{50}^{100}(X){1 \over 100}dx+\int_{100}^{150}(100){1 \over 100}dx \\
    \\
   &=& 87.5
\end{eqnarray*} 


\begin{eqnarray*}
  E[(100-X)^+]&=&\int_{-\infty}^{\infty}(100-X)^+f(x)dx \\
    \\
  &=&\int_{-\infty}^{50}(100-X)^+f(x)dx+\int_{50}^{150}(100-X)^+f(x)dx+\int_{150}^{\infty}(100-X)^+f(x)dx \\
  &=& 0+\int_{50}^{150}(100-X)^+f(x)dx+0 \\
  &=&\int_{50}^{100}(100-X){1 \over 100}dx+\int_{100}^{150}(0){1 \over 100}dx \\
    \\
   &=& 12.5
\end{eqnarray*} 



\begin{eqnarray*}
  E[100]&=&100  , constant    \qquad \qquad \qquad \qquad \qquad\qquad\qquad\qquad\qquad\qquad \qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad                                                               .\\
\end{eqnarray*} 



Thus, Expected Profit is 10(87.5)+2(12.5)-5(100)=400


\newpage





```{r message=FALSE, warning=FALSE, paged.print=TRUE}
"Newsvendor"
```
