---
title: "Daipark_ch3_손민상"
author: "Son Min Sang"  
date: "`r Sys.Date()`"  
output:   
  pdf_document:  
    latex_engine: xelatex
    highlight: haddock  
    keep_tex: true  
    includes:
      in_header: rmd-pdf-support/latex-topmatter.tex
    # pandoc_args: [
    #  "-V", "classoption=twocolumn"
    # ]
    toc: true   
    toc_depth: 2  
    # number_sections: true  
monofont: Consolas
smaller: yes
classoption: a4paper
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(background = '718CBA')
```

\newpage

## Exercise(3-5)
Suppose each morning a factory posts the number of days worked in a row without any injuries. Assume that each day is injury free with probability 98/100. Furthermore, assume that whether tomorrow is injury free or not is independent of which of the preceding days were injury free. Let $X_0 = 0$ be the morning the factory first opened. Let $X_n$ be the number posted on the morning after n full days of work.

### (a) Is ${X_n, n \geq 0}$ a Markov chain? If so, give its state space, initial distribution, and transition matrix $P$. If not, show that it is not a Markov chain.

Whether tomorrow is injury free or not is independent of which of the preceding days were injury free.(markov property)

#### State space 

$S=\{0,1\}$ 1 means injury free, 0 means not injury free.

#### Initial distribution

$\pi_0=\{1,0\}$

#### Trainsition matrix

\begin{align*}
P=
\begin {pmatrix}
&0.98 &0.02 \\
&0.98 &0.02 \\
\end {pmatrix}
\end{align*}

\vspace{10pt}

### (b) Is the Markov chain irreducible? Explain.
\begin{figure}[ht]
\centering
   \includegraphics[width=12cm]{daipark_ch3_1.png}
   \hfil
\label{Figure 2.}
\end{figure}

All states are connected in one transition. So it is irreducible.

\newpage

### (c) Is the Markov chain periodic or aperiodic? Explain and if it is periodic, also give the period.

```{python,echo=TRUE}
import numpy as np
from numpy.linalg import matrix_power
P=np.array([[0.98,0.02],[0.98,0.02]])
matrix_power(P,2)
````

\begin{align*}
P^2=
\begin {pmatrix}
&0.98 &0.02 \\
&0.98 &0.02 \\
\end {pmatrix}
\end{align*}

$P^2=P^3=P^{\infty}$

This Markov chain is periodic, the period is 1.

\vspace{10pt}

### (d) Find the stationary distribution.


$P^2=P^3=P^{\infty}$


$s=\{0.98,0.02\}$

\vspace{10pt}

### (e) Is the Markov chain positive recurrent? If so, why? If not, why not?

No, it is not recurrent.

\newpage

## Exercise(3-6)
Consider the following transition matrix:

\begin{align*}
P=
\begin {pmatrix}
&0 &0.5 &0 &0.5 \\
&0.6 &0 &0.4 &0 \\
&0 &0.7 &0 &0.3 \\
&0.8 &0 &0.2 &0 \\
\end {pmatrix}
\end{align*}

\vspace{10pt}

### (a) Is the Markov chain periodic? Give the period of each state.

```{python,echo=TRUE}
import numpy as np
from numpy.linalg import matrix_power
P=np.array([[0,0.5,0,0.5],
           [0.6,0,0.4,0],
           [0,0.7,0,0.3],
           [0.8,0,0.2,0]])
          
print(matrix_power(P,200))
print(matrix_power(P,201))
print(matrix_power(P,202))
```
$P^{200}=P^{202}$ 

$\therefore$This Markov chain is periodic, and the period is 2

\vspace{10pt}

### (b) Is A$(\pi_1,\pi_2,\pi_3,\pi_4)$ = (33/96,27/96,15/96,21/96) the stationary distribution of the Markov Chain?

$(\pi_1,\pi_2,\pi_3,\pi_4)·P$

$=(0.6\pi_{2}+0.8\pi_{4},0.5\pi_{1}+0.7\pi_{3},0.4\pi_{2}+0.2\pi_{4},0.5\pi_{1}+0.3\pi_{3})$

$=(\frac{33}{96},\frac{27}{96},\frac{15}{96},\frac{21}{96})$

$\therefore$$A$(\pi_1,\pi_2,\pi_3,\pi_4)$ is stationary distribution of the Markov Chain 

\vspace{10pt}

### (c) Is $P^{100}_{11} = \pi_1?$ $P^{101}_{11} = \pi_1?$ Is  Give an expression for $\pi_1$ in terms of $P^{100}_{11}$ and $P^{101}_{11}$.

```{python,echo=TRUE}
import numpy as np
from numpy.linalg import matrix_power
print(matrix_power(P,100))
```

```{python,echo=TRUE}
matrix_power(P,101)
```

$P_{11}^{100}=0.6875=2·\pi_1,P_{11}^{101}=0=0·\pi_1$

\newpage

## Exercise(3-14)
Suppose you are working as an independent consultant for a company.
Your performance is evaluated at the end of each month and the evaluation
falls into one of three categories: 1, 2, and 3. Your evaluation can be
modeled as a discrete-time Markov chain and its transition diagram is as
follows.

\begin{figure}[ht]
\centering
   \includegraphics[width=12cm]{daipark_ch3.png}
   \hfil
\label{Figure 2.}
\end{figure}

Denote your evaluation at the end of $n$th month by $X_n$ and assume that
$X_0 = 2$.

\vspace{10pt}

### (a) What are state space, transition probability matrix and initial distribution of $X_n$?

\vspace{10pt}

#### State space 

$S=\{1,2,3\}$

#### Initial distribution

$\pi_0=\{0,1,0\}$

#### trainsition matrix

\begin{align*}
P=
\begin {pmatrix}
&0.25 &0.75 &0   \\
&0.5  &0    &0.5 \\
&0    &0.25 &0.75\\
\end {pmatrix}
\end{align*}

\vspace{10pt}

### (b) What is the stationary distribution?

$(\pi_1,\pi_2,\pi_3)·P$

$=(0.25\pi_1+0.5\pi_2,0.75\pi_1+0.25\pi_3,0.5\pi_2+0.75\pi_3)$

$=(\pi_1,\pi_2,\pi_3)$

$\pi_1+\pi_2+\pi_3=1$

$\therefore \pi_1=\frac{2}{11},\pi_2=\frac{3}{11},\pi_3=\frac{6}{11}$

Stationary distribution $=(\frac{2}{11},\frac{3}{11},\frac{6}{11})$

\newpage

### (c) What is the long-run fraction of time when your evaluation is either 2 or 3? 

```{python,echo=TRUE}
import numpy as np
from numpy.linalg import matrix_power

P=np.array([[0.25, 0.75, 0],
          [0.5, 0, 0.5],
          [0, 0.25, 0.75]])
          
matrix_power(P,100)
```

```{python,echo=TRUE}
matrix_power(P,200)
```

\begin{align*}
P^{\infty}=
\begin {pmatrix}
&0.1818 &0.2727 &0.5454 \\
&0.1818 &0.2727 &0.5454 \\
&0.1818 &0.2727 &0.5454 \\
\end {pmatrix}
\end{align*}

Therefore, the long-run fraction of time when your evaluation is either 2 or 3

$=0.2727+0.5454=0.8181$

\vspace{20pt}

Your monthly salary is determined by the evaluation of each month in the
following way. 

Salary when your evaluation is $n = \$5000 + n^2*\$5000,\,\,\,\,\, n = 1,2,3$

### (d) What is the long-run average monthly salary?

Salary when your evaluation is 1 $= \$5000 + 1^2*\$5000=\$10000$

Salary when your evaluation is 2 $= \$5000 + 2^2*\$5000=\$25000$

Salary when your evaluation is 1 $= \$5000 + 3^2*\$5000=\$50000$

#### Average monthly salary
\
\vspace{5pt}

$10000*0.1818+25000*0.2727+50000*0.5454=\$35,905.5$